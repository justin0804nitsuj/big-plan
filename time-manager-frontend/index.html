<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Personal Time Manager</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app-container">

    <!-- =================== Header =================== -->
    <header>
      <div class="header-main">
        <div>
          <h1>Personal Time Manager</h1>
          <p>任務管理 + 番茄鐘（支援 Guest 模式 + 帳號登入 + 雲端同步）</p>
        </div>

        <div class="user-bar">
          <span id="authStatusLabel">Guest 模式</span>
          <button id="authActionBtn">登入 / 建立帳號</button>

          <!-- NEW: 設定按鈕 -->
          <button id="openSettingsBtn" class="secondary small">⚙ 設定</button>
        </div>
      </div>
    </header>

    <!-- =================== Main Content =================== -->
    <main id="mainContent">

      <!-- ========== 任務列表 ========== -->
      <section class="panel panel-tasks-list">
        <h2>任務列表</h2>
        <div class="filters">
          <button data-filter="all" class="filter-btn active">全部</button>
          <button data-filter="todo" class="filter-btn">未完成</button>
          <button data-filter="done" class="filter-btn">已完成</button>
        </div>
        <ul id="taskList" class="task-list"></ul>
      </section>

      <!-- ========== 任務表單 ========== -->
      <section class="panel panel-task-form">
        <h2>新增 / 編輯任務</h2>
        <form id="taskForm">
          <input type="hidden" id="taskId" />

          <label>標題 <input type="text" id="taskTitle" required /></label>

          <label>描述 <textarea id="taskDescription"></textarea></label>

          <label>截止日期 <input type="date" id="taskDueDate" /></label>

          <label>
            優先度
            <select id="taskPriority">
              <option value="low">Low</option>
              <option value="medium" selected>Medium</option>
              <option value="high">High</option>
            </select>
          </label>

          <label>
            分類
            <select id="taskCategory">
              <option value="">無</option>
              <option value="school">School</option>
              <option value="research">Research</option>
              <option value="game">Game Dev</option>
              <option value="personal">Personal</option>
              <option value="study">Study</option>
            </select>
          </label>

          <div class="form-actions">
            <button type="submit">儲存任務</button>
            <button type="button" id="clearFormBtn" class="secondary">清空</button>
          </div>
        </form>

        <div>
          <h3>資料備份</h3>
          <button id="exportJsonBtn">匯出 JSON</button>
          <label class="import-label">
            匯入 JSON
            <input type="file" id="importJsonInput" accept=".json" hidden />
          </label>
        </div>
      </section>

      <!-- ========== 番茄鐘 ========== -->
      <section class="panel panel-pomodoro">
        <h2>番茄鐘</h2>
        <p id="currentTaskLabel">尚未選擇任務</p>
        <div id="timerValue">25:00</div>

        <button id="startTimerBtn">Start</button>
        <button id="pauseTimerBtn" class="secondary">Pause</button>
        <button id="resetTimerBtn" class="secondary">Reset</button>

        <h3>設定</h3>
        <label>專注 <input id="focusMinutesInput" type="number" value="25" /></label>
        <label>休息 <input id="breakMinutesInput" type="number" value="5" /></label>
        <button id="saveSettingsBtn">儲存設定</button>
      </section>

      <!-- ========== 今日統計 ========== -->
      <section class="panel panel-stats">
        <h2>今日完成度統計</h2>
        <p id="todayStatsLabel">今日尚無任務記錄</p>
      </section>

    </main>

    <!-- =================== Settings Panel =================== -->
    <div id="settingsPanel" class="settings-panel hidden">
      <h2>設定</h2>

      <div class="setting-group">
        <h3>帳號資訊</h3>
        <p>目前登入：<span id="settingsUserEmail">-</span></p>
        <p>名稱：<span id="settingsUserName">-</span></p>
        <button id="changeNameBtn">修改名稱</button>
      </div>

      <div class="setting-group">
        <h3>修改密碼</h3>
        <label>新密碼 <input type="password" id="newPasswordInput"></label>
        <button id="changePasswordBtn">更新密碼</button>
      </div>

      <div class="setting-group danger-zone">
        <h3>危險區域</h3>
        <button id="deleteAccountBtn" class="danger">刪除帳號</button>
      </div>

      <button id="closeSettingsBtn" class="secondary">返回</button>
    </div>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="main.js"></script>
</body>
</html>
